# TagUI自动化证照下载系统

## 项目简介

这是一个基于TagUI的自动化证照下载系统，提供Web界面来触发TagUI脚本执行，自动下载并处理证照文件。

## 主要功能

- 🌐 Web界面控制TagUI脚本执行
- 🤖 自动化浏览器操作
- 📁 智能文件管理和移动
- 📦 ZIP文件自动解压（支持中文文件名）
- 🔍 进程监控和状态反馈
- 🧹 自动文件清理

## 快速开始

### 1. 启动系统
双击运行 `start_web_system.bat` 或执行：
```bash
python auto_run.py
```

### 2. 访问Web界面
打开浏览器访问：http://localhost:8000

### 3. 执行任务
点击"执行TagUI脚本"按钮开始自动化任务

## 🏗️ 系统架构

### 后端：`auto_run.py`
- **智能执行引擎**：自动尝试多种方式执行TagUI脚本
- **权限管理**：PowerShell提升权限 + 普通权限回退
- **HTTP API服务器**：提供RESTful API接口
- **异步执行**：非阻塞式脚本执行
- **状态监控**：实时执行状态查询

### 前端：`index.html`
- **Web界面**：证书管理系统UI
- **实时反馈**：按钮状态动态更新
- **状态轮询**：自动查询执行进度
- **错误处理**：完善的异常提示

## 🚀 使用方法

### 1. 启动系统
```bash
# 方法1：使用启动脚本（推荐）
start_web_system.bat

# 方法2：直接运行后端
python auto_run.py
```

### 2. 访问界面
在浏览器中打开：`http://localhost:8000/index.html`

### 3. 执行脚本
点击蓝色的"证件1"按钮即可执行TagUI脚本

## 📡 API接口

### POST /execute-tagui
执行TagUI脚本

**请求体：**
```json
{
    "action": "execute"  // 执行脚本
}
```

**响应：**
```json
{
    "status": "started",
    "message": "TagUI脚本已开始执行（异步）",
    "note": "脚本正在后台运行，请等待完成"
}
```

### POST /execute-tagui (状态查询)
查询执行状态

**请求体：**
```json
{
    "action": "status"  // 查询状态
}
```

**响应：**
```json
{
    "status": "running",  // idle|running
    "message": "PowerShell方式执行中...",
    "method": "PowerShell方式"
}
```

## 🔧 执行方式

系统会按优先级尝试以下执行方式：

1. **PowerShell方式**：尝试提升权限执行
2. **普通权限方式**：无权限要求的直接执行

## ✨ 特性

- ✅ **智能权限处理**：自动尝试最佳执行方式
- ✅ **实时状态更新**：Web界面实时显示执行进度
- ✅ **异步执行**：不阻塞界面响应
- ✅ **错误恢复**：多种执行方式回退机制
- ✅ **中文路径支持**：完美处理中文目录
- ✅ **编码问题解决**：UTF-8编码支持

## 📁 文件说明

- `auto_run.py` - 后端服务器（智能执行引擎）
- `index.html` - 前端Web界面
- `test3.tag` - TagUI自动化脚本
- `start_web_system.bat` - 一键启动脚本

## 🛠️ 故障排除

### 连接问题
- 确保 `auto_run.py` 正在运行
- 检查端口8000是否被占用
- 确认防火墙设置

### 执行问题
- 检查TagUI是否正确安装在 `C:\tagui\src\tagui`
- 确认 `test3.tag` 文件存在
- 查看后端控制台输出的错误信息

## 🎯 优势对比

| 方式 | 启动速度 | 权限处理 | 界面友好 | 状态反馈 |
|------|----------|----------|----------|----------|
| 直接命令行 | ⭐⭐⭐ | ❌ | ❌ | ❌ |
| 批处理文件 | ⭐⭐ | ⭐ | ❌ | ❌ |
| **Web系统** | ⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ |
