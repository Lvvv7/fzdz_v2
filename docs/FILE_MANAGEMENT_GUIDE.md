# 📁 自动文件管理功能说明

## 🎯 功能概述

TagUI脚本执行完成后，系统会自动检查下载目录并将下载的文件移动到指定位置。

## 📋 工作流程

### 1. 执行TagUI脚本
- 运行证照下载自动化脚本
- 系统自动操作浏览器下载文件

### 2. 等待下载完成
- 脚本执行完成后等待3秒
- 确保文件下载完毕

### 3. 检查下载目录
- **源目录**: `C:\Users\LvvvA\Downloads`
- **检测文件类型**: 
  - 压缩文件: `.zip`, `.rar`, `.7z`
  - 文档文件: `.pdf`, `.doc`, `.docx`, `.xls`, `.xlsx`

### 4. 智能文件识别
- 只移动**最近5分钟**内下载的文件
- 避免误移动旧文件
- 按文件修改时间排序

### 5. 文件移动
- **目标目录**: `D:\辅助打证\test\zip\`
- 如果文件名冲突，自动添加时间戳
- 显示文件大小和移动状态

## 🔧 配置说明

### 目录配置
```python
self.downloads_dir = Path("C:/Users/LvvvA/Downloads")  # 下载目录
self.target_zip_dir = Path("D:/辅助打证/test/zip")     # 目标目录
```

### 时间窗口
- **检测窗口**: 5分钟（300秒）
- **等待时间**: 3秒（让下载完成）

### 支持的文件格式
```python
file_patterns = [
    "*.zip", "*.pdf", "*.rar", "*.7z", 
    "*.doc", "*.docx", "*.xls", "*.xlsx"
]
```

## 📊 执行结果示例

### 成功案例
```
🔍 检查下载目录: C:\Users\LvvvA\Downloads
✅ 文件移动成功: 电子证照.zip -> 电子证照_20250808_143022.zip
📊 文件大小: 156.78 KB
🎉 成功移动了 1 个文件到 D:\辅助打证\test\zip
```

### 无文件案例
```
🔍 检查下载目录: C:\Users\LvvvA\Downloads
⚠️  没有找到最近下载的文件
```

## 🛡️ 安全特性

### 1. 时间限制
- 只处理最近5分钟内的文件
- 防止误移动历史文件

### 2. 文件名冲突处理
- 自动添加时间戳: `文件名_20250808_143022.扩展名`
- 保护已存在的文件

### 3. 异常处理
- 移动失败时显示详细错误信息
- 单个文件失败不影响其他文件处理

## 🔄 与Web界面集成

### 状态反馈
- 执行成功消息包含文件处理信息
- 前端显示: "PowerShell方式执行成功，文件已处理"

### 实时监控
- 通过状态轮询API获取处理进度
- 详细的控制台日志输出

## 📁 目录结构示例

```
D:\辅助打证\test\
├── zip/                          # 自动移动的文件存放目录
│   ├── 电子证照_20250808_143022.zip
│   ├── 营业执照_20250808_143156.pdf
│   └── 食品许可证_20250808_143301.zip
├── extracted_files/              # 解压后的文件目录
├── auto_run.py                   # 主程序
└── index.html                    # Web界面
```

## 💡 使用建议

1. **确保下载目录正确**: 检查Chrome浏览器的默认下载位置
2. **定期清理**: 下载目录可能积累较多文件，建议定期清理
3. **监控日志**: 关注控制台输出，了解文件处理状态
4. **备份重要文件**: 系统会移动文件，请确保重要文件有备份
